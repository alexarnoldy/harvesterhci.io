(self.webpackChunkharvesterhci=self.webpackChunkharvesterhci||[]).push([[4771],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return s},kt:function(){return k}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),u=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),m=u(a),k=r,d=m["".concat(p,".").concat(k)]||m[k]||c[k]||i;return a?n.createElement(d,l(l({ref:t},s),{},{components:a})):n.createElement(d,l({ref:t},s))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=a[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},4965:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return l},metadata:function(){return o},toc:function(){return p},default:function(){return s}});var n=a(2122),r=a(9756),i=(a(7294),a(3905)),l={sidebar_position:3},o={unversionedId:"vm-management/backup-restore",id:"version-0.2.0/vm-management/backup-restore",isDocsHomePage:!1,title:"VM Backup & Restore",description:"Available as of v0.2.0",source:"@site/versioned_docs/version-0.2.0/vm-management/backup-restore.md",sourceDirName:"vm-management",slug:"/vm-management/backup-restore",permalink:"/docs/vm-management/backup-restore",editUrl:"https://github.com/harvester/harvester.github.io/edit/master/website/versioned_docs/version-0.2.0/vm-management/backup-restore.md",version:"0.2.0",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"version-0.2.0/tutorialSidebar",previous:{title:"Access to the VM",permalink:"/docs/vm-management/access-to-the-vm"},next:{title:"Live Migration",permalink:"/docs/vm-management/live-migration"}},p=[{value:"Backup Target Setup",id:"backup-target-setup",children:[]},{value:"Create a VM backup",id:"create-a-vm-backup",children:[]},{value:"Restore a new VM using a backup",id:"restore-a-new-vm-using-a-backup",children:[]},{value:"Replace an Existing VM using a backup",id:"replace-an-existing-vm-using-a-backup",children:[]}],u={toc:p};function s(e){var t=e.components,a=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Available as of v0.2.0")),(0,i.kt)("p",null,"VM backups are created from the ",(0,i.kt)("strong",{parentName:"p"},"Virtual Machines")," page. The VM backup volumes will be stored in the ",(0,i.kt)("strong",{parentName:"p"},"Backup Target")," (an NFS or S3 server) and they can be used to either restore a new VM or replace an existing VM."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Prerequisite: A backup target must be set up. For more information, see ",(0,i.kt)("a",{parentName:"p",href:"#backup-target-setup"},"Backup Target Setup"),". If the BackupTarget has not been set, you\u2019ll be presented with a prompt message.")),(0,i.kt)("h2",{id:"backup-target-setup"},"Backup Target Setup"),(0,i.kt)("p",null,"A backup target is an endpoint used to access a backup store in Harvester. A backup store is an NFS server or S3 compatible server that stores the backups of VM volumes. The backup target can be set at ",(0,i.kt)("inlineCode",{parentName:"p"},"Settings > backup-target"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Type"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Choose S3 or NFS")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Endpoint"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"EndPoint is a hostname or an IP address. Can be left empty for AWS S3.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"BucketName"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of the bucket")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"BucketRegion"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Region of the bucket")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"AccessKeyID"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"AccessKeyID is like a user-id that uniquely identifies your account.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"SecretAccessKey"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"SecretAccessKey is the password to your account.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Certificate"),(0,i.kt)("td",{parentName:"tr",align:null},"string"),(0,i.kt)("td",{parentName:"tr",align:null},"Paste the certificate if you want to use a self-signed SSL certificate of your s3 server")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"VirtualHostedStyle"),(0,i.kt)("td",{parentName:"tr",align:null},"bool"),(0,i.kt)("td",{parentName:"tr",align:null},"Use virtual-hosted-style access only, e.g., Alibaba Cloud(Aliyun) OSS")))),(0,i.kt)("h2",{id:"create-a-vm-backup"},"Create a VM backup"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Once the backup target is set, go to the ",(0,i.kt)("inlineCode",{parentName:"li"},"Virtual Machines")," page."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Take Backup")," of the VM actions to create a new VM backup."),(0,i.kt)("li",{parentName:"ol"},"Set a custom backup name and click ",(0,i.kt)("inlineCode",{parentName:"li"},"Create")," to create a new VM backup.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Result:")," The backup is created. A notification message will be promoted, and users can go to the ",(0,i.kt)("inlineCode",{parentName:"p"},"Advanced > Backups")," page to view all VM backups."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"ReadyToUse")," status will be set to true once the Backup is complete."),(0,i.kt)("p",null,"Users can either choose to restore a new VM or replace an existing VM using this backup."),(0,i.kt)("h2",{id:"restore-a-new-vm-using-a-backup"},"Restore a new VM using a backup"),(0,i.kt)("p",null,"To restore a new VM from a backup, follow these steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Go to the ",(0,i.kt)("inlineCode",{parentName:"li"},"Backups")," page."),(0,i.kt)("li",{parentName:"ol"},"Specify the new VM name and click ",(0,i.kt)("inlineCode",{parentName:"li"},"Create"),"."),(0,i.kt)("li",{parentName:"ol"},"A new VM will be restored using the backup volumes and metadata, and users can access it from the ",(0,i.kt)("inlineCode",{parentName:"li"},"Virtual Machines")," page.")),(0,i.kt)("h2",{id:"replace-an-existing-vm-using-a-backup"},"Replace an Existing VM using a backup"),(0,i.kt)("p",null,"You can replace an existing VM using the backup with the same VM backup target ."),(0,i.kt)("p",null,"You can choose to either delete the previous volumes or retain them. By default, all previous volumes are deleted."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Requirements:")," The VM must exist and is required to be in the powered-off status."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Go to the ",(0,i.kt)("inlineCode",{parentName:"li"},"Backups")," page."),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},"Create"),".")),(0,i.kt)("p",null,"The restore process can be viewed from the ",(0,i.kt)("inlineCode",{parentName:"p"},"Virtual Machines")," page."))}s.isMDXComponent=!0}}]);